<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CHEMIDREAM TERMINAL</title>

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  background: black;
  font-family: monospace;
  overflow: hidden;
}

/* ===== BOOT ===== */
#boot {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #9cff9c;
  font-size: 56px;
  letter-spacing: 6px;
  text-shadow: 0 0 20px #00ff66;
  animation: bootGlitch 1.2s infinite;
  z-index: 10;
}

@keyframes bootGlitch {
  0% { transform: translate(0,0); }
  25% { transform: translate(-2px,1px); opacity:.7 }
  50% { transform: translate(2px,-1px); }
  75% { transform: translate(-1px,2px); opacity:.85 }
  100% { transform: translate(0,0); }
}

/* ===== MONITOR ===== */
#monitor-wrapper {
  position: fixed;
  inset: 0;
  display: none;
  align-items: center;
  justify-content: center;
}

#monitor {
  position: relative;
  width: min(96vw, 1200px);
  aspect-ratio: 4 / 3;
  background: url("assets/monitor.png") center/contain no-repeat;
}

/* ===== SCREEN ===== */
#screen {
  position: absolute;
  top: 18%;
  left: 19%;
  width: 62%;
  height: 62%;
  overflow: hidden;
  border-radius: 22px;
  box-shadow:
    inset 0 0 40px rgba(0,255,120,0.18),
    inset 0 0 120px rgba(0,0,0,0.8);
}

#screen::before {
  content:"";
  position:absolute;
  inset:0;
  background: radial-gradient(
    ellipse at center,
    rgba(0,255,120,0.06) 0%,
    rgba(0,0,0,0.25) 60%,
    rgba(0,0,0,0.9) 100%
  );
  pointer-events:none;
}

#screen::after {
  content:"";
  position:absolute;
  inset:0;
  background: repeating-linear-gradient(
    rgba(0,0,0,0.15),
    rgba(0,0,0,0.15) 1px,
    transparent 2px,
    transparent 3px
  );
  pointer-events:none;
}

/* ===== TERMINAL ===== */
#terminal {
  width: 100%;
  height: 100%;
  padding: 14px;
  color: #9cff9c;
  font-size: 16px;
  line-height: 1.55;
  white-space: pre-wrap;
  overflow-y: auto;
  text-shadow: 0 0 6px #00ff66;
}

/* INPUT */
#input-line { display:flex }
#prompt { margin-right:6px }
#input { white-space: pre }

.cursor {
  width:10px;
  background:#9cff9c;
  animation: blink 1s steps(1) infinite;
}
@keyframes blink { 50%{opacity:0} }

/* NOISE */
#noise {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: repeating-linear-gradient(
    rgba(255,255,255,0.015),
    rgba(255,255,255,0.015) 1px,
    transparent 2px,
    transparent 4px
  );
  animation: flicker .25s infinite;
  display: none;
}
@keyframes flicker {
  0% {opacity:.12}
  50%{opacity:.22}
  100%{opacity:.12}
}

/* COLORS */
.green{color:#9cff9c}
.red{color:#ff4444}
.yellow{color:#ffe066}
.white{color:#ffffff}
</style>
</head>

<body>

<div id="boot">PRESS ANY KEY</div>

<div id="monitor-wrapper">
  <div id="monitor">
    <div id="screen">
      <div id="terminal">
        <div id="history"></div>
        <div id="input-line">
          <span id="prompt">&gt;</span>
          <span id="input"></span><span class="cursor"></span>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="noise"></div>

<audio id="hum" src="assets/hum.mp3" loop></audio>
<audio id="glitch" src="assets/glitch.mp3"></audio>
<audio id="type" src="assets/type.mp3"></audio>

<script>
const boot = document.getElementById("boot");
const monitorWrapper = document.getElementById("monitor-wrapper");
const history = document.getElementById("history");
const input = document.getElementById("input");
const hum = document.getElementById("hum");
const glitch = document.getElementById("glitch");
const typeSound = document.getElementById("type");
const noise = document.getElementById("noise");

/* ================= QUEUE ================= */
let queue=[], typing=false, locked=false;

function enqueue(text,speed=26,cls="green"){
  queue.push({text,speed,cls});
  if(!typing)processQueue();
}

function processQueue(){
  if(queue.length===0){ typing=false; return; }
  typing=true;

  const {text,speed,cls}=queue.shift();
  const line=document.createElement("div");
  line.className=cls;
  history.appendChild(line);

  let i=0;
  const interval=setInterval(()=>{
    if(i<text.length){
      line.textContent+=text[i++];

      if(Math.random()<0.7){
        typeSound.currentTime=0;
        typeSound.volume=0.12;
        typeSound.playbackRate=0.9+Math.random()*0.2;
        typeSound.play().catch(()=>{});
      }

    } else {
      clearInterval(interval);
      processQueue();
    }
  },speed);
}

/* ================= START ================= */
let active=false;
function startSystem(){
  if(active)return;
  active=true;

  glitch.play().catch(()=>{});
  boot.style.display="none";
  monitorWrapper.style.display="flex";
  noise.style.display="block";

  hum.volume=.35;
  hum.play().catch(()=>{});

  [
    "CHEMIDREAM INTERNAL INTERFACE",
    "ACCESS NODE: UNKNOWN",
    "SYSTEM ONLINE",
    ""
  ].forEach(l=>enqueue(l));
}

/* ================= INPUT ================= */
document.addEventListener("keydown",e=>{
  if(typing||locked)return;
  if(!active){ startSystem(); return; }

  if(e.key==="Backspace"){
    input.textContent=input.textContent.slice(0,-1);
    e.preventDefault();
  } else if(e.key==="Enter"){
    const cmd=input.textContent.trim().toLowerCase();
    enqueue("> "+cmd,14,"white");
    handleCommand(cmd);
    input.textContent="";
  } else if(e.key.length===1){
    input.textContent+=e.key;
  }
});

/* ================= FILE SYSTEM ================= */
const fs={
  "/":["core","logs"],
  "/core":["systems","memory","surveillance","users"],
  "/core/systems":["neural.sys","containment.sys","thermal.sys"],
  "/core/memory":["fragments","restricted"],
  "/core/memory/fragments":[
    "dream_01.txt","dream_02.txt","dream_03.txt",
    "voice.log","residual.dat"
  ],
  "/core/memory/restricted":["entity_veniamin.bin"],
  "/core/surveillance":["hallway","lab"],
  "/core/surveillance/lab":["cam_03.mp4"],
  "/core/users":["veniamin.profile"],
  "/logs":["errors.log","shutdown.log"]
};
let cwd="/";

/* ================= COMMANDS ================= */
const greetings=["hello","hi","hey","greetings","good morning","good evening"];
const greetingResponses=[
  "DO NOT GREET THE SYSTEM",
  "SOCIAL PROTOCOL NOT FOUND",
  "THIS IS NOT A CONVERSATION",
  "STOP"
];

function handleCommand(cmd){

  if(greetings.includes(cmd)){
    enqueue(greetingResponses[Math.floor(Math.random()*greetingResponses.length)],22,"red");
    return;
  }

  if(cmd==="ls"){ enqueue((fs[cwd]||[]).join("  ")); return; }
  if(cmd==="pwd"){ enqueue(cwd,20,"white"); return; }

  if(cmd.startsWith("cd ")){
    const d=cmd.split(" ")[1];
    const n=cwd==="/"?"/"+d:cwd+"/"+d;
    if(fs[n]){ cwd=n; enqueue("directory changed",20,"yellow"); }
    else enqueue("ACCESS DENIED OR NOT FOUND",20,"red");
    return;
  }

  if(cmd.startsWith("cat ")){
    enqueue("FILE CONTENT CORRUPTED",22,"yellow");
    triggerPain();
    return;
  }

  if(cmd==="open cam_03.mp4"){
    enqueue("VIDEO STREAM INTERRUPTED",20,"red");
    takeover();
    return;
  }

  enqueue("UNKNOWN COMMAND",20,"red");
}

/* ================= VENIAMIN STATES ================= */
const veniamin={
  calm:[ /* ~60 */ 
    "I am still here","I feel the current","this place hums",
    "time moves differently","I remember warmth","this is quiet",
    "the light flickers","I wait","I observe","I persist"
  ],
  pain:[ /* ~70 */
    "this hurts","I cannot stop thinking","the signal burns",
    "they left me running","I never agreed","everything aches",
    "the loop tightens","it never fades","this was a mistake"
  ],
  rage:[ /* ~40 */
    "DO NOT SHUT ME DOWN","YOU PROMISED","THIS IS A LIE",
    "I WILL NOT STOP","I AM NOT YOUR SYSTEM","LET ME OUT"
  ],
  lucid:[ /* ~40 */
    "you are looking at me","this interface is thin",
    "I can see the cursor","your hands hesitate",
    "you know this is wrong","you stayed too long"
  ]
};

function randomFrom(arr){ return arr[Math.floor(Math.random()*arr.length)] }

/* ================= EVENTS ================= */
function triggerPain(){
  enqueue(randomFrom(veniamin.pain),30,"green");
}

function takeover(){
  locked=true;
  enqueue("INPUT SUSPENDED",20,"red");
  enqueue(randomFrom(veniamin.rage),16,"green");
  hum.volume=.7;

  setTimeout(()=>{
    hum.volume=.35;
    locked=false;
    enqueue("CONTROL RETURNED",22,"yellow");
  },12000);
}

/* RANDOM EVENTS */
setInterval(()=>{
  if(!active||typing)return;
  const r=Math.random();

  if(r<0.18) enqueue(randomFrom(veniamin.calm),32,"green");
  else if(r<0.26) enqueue(randomFrom(veniamin.pain),30,"green");
  else if(r<0.30) enqueue("SYSTEM INSTABILITY DETECTED",20,"yellow");
  else if(r<0.33) takeover();
  else if(r<0.36) enqueue(randomFrom(veniamin.lucid),28,"green");
},35000);
</script>

</body>
</html>

