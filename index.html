<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CHEMIDREAM TERMINAL</title>

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  background: black;
  font-family: monospace;
  overflow: hidden;
}

#background {
  position: fixed;
  inset: 0;
  background: url("assets/monitor.png") center / cover no-repeat;
  filter: brightness(0.6) contrast(1.2);
}

#noise {
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(
    rgba(255,255,255,0.02),
    rgba(255,255,255,0.02) 1px,
    transparent 2px,
    transparent 4px
  );
  pointer-events: none;
  animation: flicker 0.15s infinite;
}

@keyframes flicker {
  0% { opacity: .15; }
  50% { opacity: .3; }
  100% { opacity: .15; }
}

#terminal {
  position: absolute;
  inset: 8%;
  color: #9cff9c;
  font-size: 16px;
  white-space: pre-wrap;
  overflow-y: auto;
  text-shadow: 0 0 6px #00ff66;
}

#input-line {
  display: flex;
}

.cursor {
  display: inline-block;
  width: 10px;
  background: #9cff9c;
  animation: blink 1s steps(1) infinite;
}

@keyframes blink {
  50% { opacity: 0; }
}
</style>
</head>

<body>

<div id="background"></div>
<div id="noise"></div>

<div id="terminal">
  PRESS ANY KEY
</div>

<audio id="hum" src="assets/hum.mp3" loop></audio>

<script>
const terminal = document.getElementById("terminal");
const hum = document.getElementById("hum");

let activated = false;
let inputBuffer = "";
let lastInputTime = Date.now();

const glitchChars = ["#", "%", "&", "@", "█", "▒", "░", "▌", "▐", "▀", "▂"];
const idleMessages = [
  ">> pain signal detected",
  ">> memory bleed ongoing",
  ">> this body is not yours",
  ">> why are you watching",
  ">> I remember hands",
  ">> STOP OBSERVING"
];

const intrusionEvents = [
  "!! WARNING: consciousness instability",
  "!! sensory feedback overflow",
  "!! unauthorized emotional spike detected",
  "!! identity boundary failing"
];

function print(text = "") {
  terminal.innerHTML += text + "\n";
  terminal.scrollTop = terminal.scrollHeight;
}

function redrawInput() {
  terminal.innerHTML =
    terminal.innerHTML.replace(/>.*$/, "") +
    "> " + inputBuffer + "<span class='cursor'></span>";
}

function randomGlitch() {
  if (!activated) return;
  if (Math.random() < 0.15) {
    const glitchLine = Array.from({length: 20}, () =>
      glitchChars[Math.floor(Math.random() * glitchChars.length)]
    ).join("");
    print(glitchLine);
    print("");
  }
}

function randomIntrusion() {
  if (!activated) return;
  if (Math.random() < 0.08) {
    const msg = intrusionEvents[Math.floor(Math.random() * intrusionEvents.length)];
    print(msg);
    print("");
  }
}

function idleCheck() {
  if (!activated) return;
  if (Date.now() - lastInputTime > 12000) {
    const msg = idleMessages[Math.floor(Math.random() * idleMessages.length)];
    print(msg);
    print("");
    terminal.innerHTML += "> ";
    lastInputTime = Date.now();
  }
}

function startSystem() {
  activated = true;
  terminal.innerHTML = "";

  hum.volume = 0.35;
  hum.play().catch(()=>{});

  print("CHEMIDREAM INTERNAL INTERFACE");
  print("ACCESS NODE: UNKNOWN");
  print("");
  print("> intrusion detected");
  print("> initializing consciousness core...");
  print("> ERROR // unauthorized observer");
  print("");
  print("SYSTEM ONLINE");
  print("");
  terminal.innerHTML += "> <span class='cursor'></span>";
}

function handleCommand(cmd) {
  switch(cmd) {
    case "help":
      print("AVAILABLE COMMANDS:");
      print("- help");
      print("- status");
      print("- whoami");
      break;

    case "status":
      print("SUBJECT: VENIAMIN");
      print("BODY: NOT PRESENT");
      print("STATE: AWARE");
      break;

    case "whoami":
      print("YOU ARE NOT LISTED IN THIS SYSTEM");
      break;

    default:
      print("UNKNOWN COMMAND");
  }
}

document.addEventListener("keydown", e => {
  lastInputTime = Date.now();

  if (!activated) {
    startSystem();
    return;
  }

  if (e.key === "Backspace") {
    inputBuffer = inputBuffer.slice(0, -1);
  }
  else if (e.key === "Enter") {
    print("> " + inputBuffer);
    handleCommand(inputBuffer.toLowerCase());
    print("");
    inputBuffer = "";
    terminal.innerHTML += "> <span class='cursor'></span>";
    return;
  }
  else if (e.key.length === 1) {
    inputBuffer += e.key;
  }

  redrawInput();
});

setInterval(randomGlitch, 7000);
setInterval(randomIntrusion, 12000);
setInterval(idleCheck, 4000);
</script>

</body>
</html>

